@model RegisterMentorModel
@using System.IO

@{
    var base64String = "#";

    if (Model?.Picture != null && Model?.Picture.Length > 0)
    {
        using (var ms = new MemoryStream())
        {
            Model.Picture.CopyTo(ms);
            var fileBytes = ms.ToArray();
            base64String = Convert.ToBase64String(fileBytes);
        }
    }
}

@using (Html.BeginForm("RegisterMentor", "Authentication", FormMethod.Post, new { @enctype = "multipart/form-data" }))

{
    <h2>Cadastrar como mentor</h2>
    <div class="form-group">
        @Html.LabelFor(m => m.Name)
        @Html.EditorFor(m => m.Name, new { htmlAttributes = new { placeholder = "Digite seu nome completo", @class = "form-control" } })
        @Html.ValidationMessageFor(m => m.Name)
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.Email)
        @Html.EditorFor(m => m.Email, new { htmlAttributes = new { placeholder = "Digite seu e-mail", @class = "form-control" } })
        @Html.ValidationMessageFor(m => m.Email)
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.PhoneNumber)
        @Html.EditorFor(m => m.PhoneNumber, new { htmlAttributes = new { placeholder = "(XX) X XXXX-XXXX", @class = "form-control" } })
        @Html.ValidationMessageFor(m => m.PhoneNumber)
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.GraduationId)
        @Html.DropDownListFor(m => m.GraduationId, (List<SelectListItem>)ViewBag.Graduations, "Selecione seu curso de graduação", new { @class = "form-control" })
        @Html.ValidationMessageFor(m => m.GraduationId)
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.RemainingMissingHours)
        @Html.EditorFor(m => m.RemainingMissingHours, new { htmlAttributes = new { placeholder = "Digite o número de horas complementares pendentes", @class = "form-control" } })
        @Html.ValidationMessageFor(m => m.RemainingMissingHours)
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.WorkingField)
        @Html.EditorFor(m => m.WorkingField, new { htmlAttributes = new { placeholder = "Informe seu cargo caso esteja trabalhando (opcional)", @class = "form-control" } })
        @Html.ValidationMessageFor(m => m.WorkingField)
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.Password)
        @Html.EditorFor(m => m.Password, new { htmlAttributes = new { placeholder = "Digite sua senha", @class = "form-control" } })
        @Html.ValidationMessageFor(m => m.Password)
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.ConfirmPassword)
        @Html.EditorFor(m => m.ConfirmPassword, new { htmlAttributes = new { placeholder = "Repita sua senha", @class = "form-control" } })
        @Html.ValidationMessageFor(m => m.Password)
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Picture)
        <br /><input type="file" name="Picture" id="Picture" accept=".png" />
        @Html.ValidationMessageFor(m => m.Picture)
    </div>

    var display = "none";

    @if (Model?.Picture != null)
    {
        display = "block";
    }

    <div class="form-group" style="display: @display" id="displayImage">
        @Html.Label("Foto carregada")
        <img src="data:image/png;base64,@base64String" alt="" id="img" /><br />
    </div>

    @Html.HiddenFor(m => m.Type)

    <input class="btn btn-lg btn-primary btn-block" style="margin-top:39px;" type="submit" name="Cadastrar" value="Cadastrar" />
}


@section Scripts {

    <script>
        $('#Picture').change(function () {
            var input = this;
            var url = $(this).val();
            var ext = url.substring(url.lastIndexOf('.') + 1).toLowerCase();
            if (input.files && input.files[0] && ext == "png") {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $('#img').attr('src', e.target.result);
                }
                reader.readAsDataURL(input.files[0]);
                $('#displayImage').show();
            }
            //else {
            //    $('#img').attr('src', '/assets/no_preview.png');
            //}
        });

    </script>
}

<style>
    img {
        display: block;
        max-width: 200px;
        max-height: 200px;
        width: auto;
        height: auto;
    }
</style>